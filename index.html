<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Minion å¤©æ°£</title>
<link rel="icon" type="image/png" href="./weather-app-02.png"> 
<link rel="apple-touch-icon" href="./weather-app-02.png"> 
<link rel="apple-touch-icon" sizes="180x180" href="./weather-app-02.png">
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">

<style>
/* -------------------------------
   å°å°å…µä¸»é¡Œé…è‰²
--------------------------------*/
:root {
  --minion-yellow: #FFEB3B;
  --minion-blue: #2962FF;
  --minion-dark: #333;
  --minion-white: #fff;
  --soft-shadow: rgba(0,0,0,0.2);
}

body {
  font-family: "Fredoka", sans-serif;
  background: var(--minion-yellow);
  margin: 0;
  padding: 0;
  color: var(--minion-dark);
  overflow-x: hidden;
}

/* -------------------------------
   é¦™è•‰é£„è½å‹•ç•«
--------------------------------*/
.banana {
  position: fixed;
  top: -60px;
  left: 0;
  font-size: 2.2rem;
  pointer-events: none;
  animation: fall linear infinite;
  opacity: 0.9;
}

@keyframes fall {
  0% {
    transform: translateY(-50px) rotate(0deg);
    opacity: 0.9;
  }
  100% {
    transform: translateY(110vh) rotate(360deg);
    opacity: 0.2;
  }
}

/* -------------------------------
   ç‹€æ…‹åˆ—
--------------------------------*/
.status-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  background: rgba(255,255,255,0.4);
  backdrop-filter: blur(10px);
  position: sticky;
  top: 0;
  z-index: 100;
  border-bottom: 4px solid var(--minion-blue);
}

.location-pill {
  background: var(--minion-blue);
  color: white;
  padding: 6px 18px;
  border-radius: 20px;
  font-weight: 700;
}

.update-pill {
  font-size: 0.8rem;
  color: var(--minion-dark);
  background: rgba(255,255,255,0.6);
  padding: 4px 12px;
  border-radius: 10px;
}

/* -------------------------------
   å°å°å…µè§’è‰²æ»‘å‹•å€
--------------------------------*/
.character-slider {
  width: 100%;
  overflow-x: scroll;
  scrollbar-width: none;
  display: flex;
  gap: 40px;
  padding: 20px 0 10px 0;
  justify-content: center;
}
.character-slider::-webkit-scrollbar { display: none; }

.character-card {
  min-width: 160px;
  text-align: center;
  transition: transform .3s;
  cursor: pointer;
}
.character-card.active {
  transform: scale(1.15);
}

.character-img {
  width: 110px;
  height: 110px;
  object-fit: contain;
  border-radius: 50%;
  background: var(--minion-white);
  border: 5px solid var(--minion-blue);
  box-shadow: 0 4px 8px var(--soft-shadow);
}

.character-name {
  margin-top: 8px;
  font-weight: 700;
  font-size: 1.1rem;
  color: var(--minion-blue);
}

/* -------------------------------
   ä¸»å¤©æ°£å¡ç‰‡
--------------------------------*/
.hero-card {
  background: var(--minion-white);
  border-radius: 35px;
  padding: 30px 20px;
  text-align: center;
  width: 90%;
  margin: 0 auto 30px;
  border: 4px solid var(--minion-blue);
  box-shadow: 0 8px 20px var(--soft-shadow);
  position: relative;
}

.hero-period {
  position: absolute;
  top: -18px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--minion-blue);
  color: #fff;
  padding: 5px 20px;
  border-radius: 15px;
  font-weight: 700;
}

.hero-temp-container {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  margin: 16px 0;
}

.hero-icon {
  font-size: 4rem;
}

.hero-temp {
  font-size: 4rem;
  font-weight: 700;
  color: var(--minion-dark);
}

.hero-desc {
  font-size: 1.4rem;
  font-weight: 600;
  margin-bottom: 20px;
}

/* å»ºè­°å°æ–¹å¡Š */
.advice-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.advice-item {
  background: #f4f4f4;
  padding: 15px;
  border-radius: 18px;
  border: 2px solid #eee;
}

.advice-icon {
  font-size: 1.6rem;
}

.advice-text {
  font-weight: 700;
  margin: 6px 0 4px 0;
}

/* -------------------------------
   æœªä¾†é å ±
--------------------------------*/
.section-title {
  font-size: 1.2rem;
  font-weight: 700;
  margin: 0 20px 10px;
}

.scroll-container {
  display: flex;
  overflow-x: auto;
  gap: 15px;
  padding: 0 20px 20px;
  scrollbar-width: none;
}
.scroll-container::-webkit-scrollbar { display: none; }

.mini-card {
  min-width: 120px;
  background: var(--minion-white);
  border-radius: 18px;
  padding: 12px;
  text-align: center;
  border: 3px solid var(--minion-blue);
}

/* -------------------------------
   Loading ç•«é¢
--------------------------------*/
.loading-screen {
  position: fixed;
  inset: 0;
  background: var(--minion-yellow);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 999;
}
</style>
<script>
/*--------------------------------
  é¦™è•‰é£„è½æ•ˆæœ
--------------------------------*/
function createBanana() {
  const banana = document.createElement("div");
  banana.classList.add("banana");
  banana.textContent = "ğŸŒ";

  // random position
  banana.style.left = Math.random() * window.innerWidth + "px";

  // random duration
  banana.style.animationDuration = (3 + Math.random() * 4) + "s";

  document.body.appendChild(banana);

  // remove after animation
  setTimeout(() => {
    banana.remove();
  }, 7000);
}

// create banana every 500â€“900ms
setInterval(createBanana, 600);
</script>
</head>

<body>

<div id="loading" class="loading-screen">
  <div style="font-size:4rem;">ğŸŒ</div>
  <p style="font-weight:700; margin-top:20px;">å°å°å…µè¼‰å…¥ä¸­...</p>
</div>

<div class="status-bar">
  <div class="location-pill">ğŸ“ è‡ºå—</div>
  <div id="updateTime" class="update-pill">æ›´æ–°ä¸­...</div>
</div>

<!-- è§’è‰²æ»‘å‹•å€ -->
<div class="character-slider" id="charSlider">
  <div class="character-card active" data-name="Kevin">
    <img src="kevin.png" class="character-img">
    <div class="character-name">Kevin</div>
  </div>

  <div class="character-card" data-name="Bob">
    <img src="bob.png" class="character-img">
    <div class="character-name">Bob</div>
  </div>

  <div class="character-card" data-name="Stuart">
    <img src="stuart.png" class="character-img">
    <div class="character-name">Stuart</div>
  </div>
</div>

<div id="mainContent" style="display:none;">
  <div id="heroCard"></div>

  <h3 class="section-title">ç¨å¾Œé å ±</h3>
  <div class="scroll-container" id="futureForecasts"></div>
</div>

<script>
/*--------------------------------
  è§’è‰²åˆ‡æ›åŠŸèƒ½
--------------------------------*/
const cards = document.querySelectorAll(".character-card");
cards.forEach(c => {
  c.addEventListener("click", () => {
    cards.forEach(x => x.classList.remove("active"));
    c.classList.add("active");
  });
});

/*--------------------------------
  å¤©æ°£ API
--------------------------------*/
const API_URL = "https://weather-joyce.zeabur.app/api/weather/kaohsiung";

function getWeatherIcon(w) {
  if (!w) return "ğŸŒ¤ï¸";
  if (w.includes("æ™´")) return "ğŸŒ";
  if (w.includes("å¤šé›²")) return "â˜ï¸";
  if (w.includes("é™°")) return "ğŸŒ«ï¸";
  if (w.includes("é›¨")) return "ğŸŒ§ï¸";
  if (w.includes("é›·")) return "â›ˆï¸";
  return "ğŸŒ¤ï¸";
}

function getAdvice(rainProb, maxTemp) {
  let rainIcon = "ğŸŒ‚";
  let rainText = "ä¸ç”¨å¸¶å‚˜";
  if (parseInt(rainProb) > 30) {
    rainIcon = "â˜”ï¸";
    rainText = "è¨˜å¾—å¸¶å‚˜ï¼";
  }

  let clothIcon = "ğŸ‘•";
  let clothText = "èˆ’é©ç©¿æ­";
  if (parseInt(maxTemp) >= 28) {
    clothIcon = "ğŸ½";
    clothText = "çŸ­è¢– OK";
  } else if (parseInt(maxTemp) <= 20) {
    clothIcon = "ğŸ§¥";
    clothText = "åŠ ä»¶å¤–å¥—";
  }

  return { rainIcon, rainText, clothIcon, clothText };
}

function getTimePeriod(t) {
  const h = new Date(t).getHours();
  if (h >= 5 && h < 11) return "æ—©æ™¨";
  if (h >= 11 && h < 14) return "ä¸­åˆ";
  if (h >= 14 && h < 18) return "ä¸‹åˆ";
  if (h >= 18 && h < 23) return "æ™šä¸Š";
  return "æ·±å¤œ";
}

function renderWeather(data) {
  const forecasts = data.forecasts;
  const current = forecasts[0];
  const others = forecasts.slice(1);

  const advice = getAdvice(current.rain, current.maxTemp);
  const period = getTimePeriod(current.startTime);
  const avgTemp = Math.round((+current.maxTemp + +current.minTemp) / 2);

  document.getElementById("heroCard").innerHTML = `
    <div class="hero-card">
      <div class="hero-period">${period}</div>

      <div class="hero-temp-container">
        <div class="hero-icon">${getWeatherIcon(current.weather)}</div>
        <div class="hero-temp">${avgTemp}Â°</div>
      </div>

      <div class="hero-desc">${current.weather}</div>

      <div class="advice-grid">
        <div class="advice-item">
          <div class="advice-icon">${advice.rainIcon}</div>
          <div class="advice-text">${advice.rainText}</div>
          <div style="font-size:0.75rem; color:#555">é™é›¨ç‡ ${current.rain}</div>
        </div>

        <div class="advice-item">
          <div class="advice-icon">${advice.clothIcon}</div>
          <div class="advice-text">${advice.clothText}</div>
          <div style="font-size:0.75rem; color:#555">æœ€é«˜æº« ${current.maxTemp}Â°</div>
        </div>
      </div>
    </div>
  `;

  const list = document.getElementById("futureForecasts");
  list.innerHTML = "";

  const today = new Date().getDate();

  others.forEach(f => {
    let p = getTimePeriod(f.startTime);
    const fd = new Date(f.startTime);
    if (fd.getDate() !== today) p = "æ˜å¤©" + p;

    list.innerHTML += `
      <div class="mini-card">
        <div style="font-weight:700;">${p}</div>
        <div style="font-size:2rem;">${getWeatherIcon(f.weather)}</div>
        <div>${f.minTemp}Â° - ${f.maxTemp}Â°</div>
        <div style="font-size:0.8rem;">ğŸ’§${f.rain}</div>
      </div>
    `;
  });

  const now = new Date();
  const month = now.getMonth() + 1;
  const day = now.getDate();
  const weekday = ["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"][now.getDay()];
  document.getElementById("updateTime").textContent = `${month}/${day}ï¼ˆé€±${weekday}ï¼‰`;
}

async function fetchWeather() {
  try {
    const delay = new Promise(r => setTimeout(r, 1400));
    const req = fetch(API_URL).then(r => r.json());
    const [_, json] = await Promise.all([delay, req]);

    if (!json.success) throw new Error("API Error");

    renderWeather(json.data);
    document.getElementById("loading").style.display = "none";
    document.getElementById("mainContent").style.display = "block";
  } catch (e) {
    alert("å¤©æ°£è³‡æ–™è®€å–å¤±æ•—ï¼");
  }
}

document.addEventListener("DOMContentLoaded", fetchWeather);
</script>

</body>
</html>